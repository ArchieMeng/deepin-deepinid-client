<html>

<head>
    <meta charset="UTF-8">
    <link href="style.css" rel="stylesheet">
    <title>Error</title>
</head>

<body>
    <div id="error_main">
        <img id="cloud_offline" src="cloud_offline.svg">

        <div class="error_title" i18n-content="Cloud sync login">
	</div>

        <div class="error_content" i18n-content="Network error, please try again later!">
	</div>

        <div class="submit_bt">
	    <button type="submit" id="submit_bt" i18n-content="Close" />
	</div>
    </div>

    <script src="di18n.min.js"></script>
    <script>
        var language;
	if (window.navigator.languages) {
	    language = window.navigator.languages[0];
	} else {
	    language = window.navigator.userLanguage || window.navigator.language;
	}

        var chineseList = ['zh', 'zh_CN', 'zh-CN'];
	if (chineseList.includes(language)) {
	    language = 'zh-CN';
	} else {
	    language = 'en';
	}

        const di18n = new DI18n({
	    locale: language,
	    isReplace: true,
	    messages: {
	        'en': {
		    "Cloud sync login": "Cloud sync login",
		    "Network error, please try again later!": "Network error, please try again later!",
		    "Close": "Close",
		},
		'zh-CN': {
		    "Cloud sync login": "云同步登录",
		    "Network error, please try again later!": "当前没有网络连接，请联网后重试！",
		    "Close": "关闭",
		}
		}
	})

        function nativeExec(handler, data) {
	    if (window['QWebChannel'] && window['qt']) {
	        window['QWebChannel'](window['qt'].webChannelTransport, channel => {
		    handler(channel, data);
		});
		}
	}

        document.addEventListener("DOMContentLoaded", function (event) {
	    console.log("DOM fully loaded and parsed");

            var register = document.getElementById('submit_bt');
	    register.addEventListener('click', function (e) {
	        var targetWindow = window.opener || window.parent;
		if (targetWindow) {
		    nativeExec(function (channel, data) {
		        channel.objects.client.close();
			}, "")
		    e.preventDefault();
		}
		});
	});
    </script>
</body>

</html>
